<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DevOps | AlexTao çš„ åšå®¢</title>
    <meta name="description" content="In doing we learn.">
    <link rel="icon" href="favicon.ico">
    
    <link rel="preload" href="/Weblog/assets/css/styles.bc17a3fe.css" as="style"><link rel="preload" href="/Weblog/assets/js/app.bc17a3fe.js" as="script"><link rel="preload" href="/Weblog/assets/js/20.5b430c8f.js" as="script"><link rel="prefetch" href="/Weblog/assets/css/16.styles.2339a627.css"><link rel="prefetch" href="/Weblog/assets/css/5.styles.c1152841.css"><link rel="prefetch" href="/Weblog/assets/css/7.styles.1f4a6057.css"><link rel="prefetch" href="/Weblog/assets/css/8.styles.5b6e1357.css"><link rel="prefetch" href="/Weblog/assets/js/0.a8dcd889.js"><link rel="prefetch" href="/Weblog/assets/js/10.bbae2931.js"><link rel="prefetch" href="/Weblog/assets/js/100.b8573d34.js"><link rel="prefetch" href="/Weblog/assets/js/101.abec8cfc.js"><link rel="prefetch" href="/Weblog/assets/js/102.79aa7798.js"><link rel="prefetch" href="/Weblog/assets/js/11.249c3d32.js"><link rel="prefetch" href="/Weblog/assets/js/12.6c4f9a9d.js"><link rel="prefetch" href="/Weblog/assets/js/13.9c3a7225.js"><link rel="prefetch" href="/Weblog/assets/js/14.8788763f.js"><link rel="prefetch" href="/Weblog/assets/js/15.c3d91b4b.js"><link rel="prefetch" href="/Weblog/assets/js/16.2339a627.js"><link rel="prefetch" href="/Weblog/assets/js/17.f68b5694.js"><link rel="prefetch" href="/Weblog/assets/js/18.1dc877c8.js"><link rel="prefetch" href="/Weblog/assets/js/19.8d3a8eb9.js"><link rel="prefetch" href="/Weblog/assets/js/2.adb0855b.js"><link rel="prefetch" href="/Weblog/assets/js/21.7570ba60.js"><link rel="prefetch" href="/Weblog/assets/js/22.c34e9396.js"><link rel="prefetch" href="/Weblog/assets/js/23.d89c70ce.js"><link rel="prefetch" href="/Weblog/assets/js/24.cc87bb5d.js"><link rel="prefetch" href="/Weblog/assets/js/25.024b7a56.js"><link rel="prefetch" href="/Weblog/assets/js/26.0d0e2118.js"><link rel="prefetch" href="/Weblog/assets/js/27.fd65c2c2.js"><link rel="prefetch" href="/Weblog/assets/js/28.e7e81b37.js"><link rel="prefetch" href="/Weblog/assets/js/29.d69a29c6.js"><link rel="prefetch" href="/Weblog/assets/js/3.9c9ae281.js"><link rel="prefetch" href="/Weblog/assets/js/30.e02a9f2a.js"><link rel="prefetch" href="/Weblog/assets/js/31.4d5d63f6.js"><link rel="prefetch" href="/Weblog/assets/js/32.2652c4b5.js"><link rel="prefetch" href="/Weblog/assets/js/33.f81118fb.js"><link rel="prefetch" href="/Weblog/assets/js/34.6539d2a9.js"><link rel="prefetch" href="/Weblog/assets/js/35.479b4b73.js"><link rel="prefetch" href="/Weblog/assets/js/36.24e9784f.js"><link rel="prefetch" href="/Weblog/assets/js/37.13a7e720.js"><link rel="prefetch" href="/Weblog/assets/js/38.57e7625b.js"><link rel="prefetch" href="/Weblog/assets/js/39.40ddc61b.js"><link rel="prefetch" href="/Weblog/assets/js/4.cb1adf5e.js"><link rel="prefetch" href="/Weblog/assets/js/40.4abade23.js"><link rel="prefetch" href="/Weblog/assets/js/41.03a22716.js"><link rel="prefetch" href="/Weblog/assets/js/42.4bf6acac.js"><link rel="prefetch" href="/Weblog/assets/js/43.7d75114c.js"><link rel="prefetch" href="/Weblog/assets/js/44.a74a0979.js"><link rel="prefetch" href="/Weblog/assets/js/45.224f0ae1.js"><link rel="prefetch" href="/Weblog/assets/js/46.716c0ee0.js"><link rel="prefetch" href="/Weblog/assets/js/47.a44c77ff.js"><link rel="prefetch" href="/Weblog/assets/js/48.c92bc6c3.js"><link rel="prefetch" href="/Weblog/assets/js/49.78d85a96.js"><link rel="prefetch" href="/Weblog/assets/js/5.c1152841.js"><link rel="prefetch" href="/Weblog/assets/js/50.65d4cc82.js"><link rel="prefetch" href="/Weblog/assets/js/51.dfe21a00.js"><link rel="prefetch" href="/Weblog/assets/js/52.a55d1d66.js"><link rel="prefetch" href="/Weblog/assets/js/53.24e5ba30.js"><link rel="prefetch" href="/Weblog/assets/js/54.3d44c9e1.js"><link rel="prefetch" href="/Weblog/assets/js/55.5509d3c1.js"><link rel="prefetch" href="/Weblog/assets/js/56.389f0044.js"><link rel="prefetch" href="/Weblog/assets/js/57.a6410cdf.js"><link rel="prefetch" href="/Weblog/assets/js/58.99de433a.js"><link rel="prefetch" href="/Weblog/assets/js/59.f362327e.js"><link rel="prefetch" href="/Weblog/assets/js/6.829d0e7e.js"><link rel="prefetch" href="/Weblog/assets/js/60.d8a731fd.js"><link rel="prefetch" href="/Weblog/assets/js/61.c32405a4.js"><link rel="prefetch" href="/Weblog/assets/js/62.2cf15697.js"><link rel="prefetch" href="/Weblog/assets/js/63.97976992.js"><link rel="prefetch" href="/Weblog/assets/js/64.df2f0acc.js"><link rel="prefetch" href="/Weblog/assets/js/65.0365fc24.js"><link rel="prefetch" href="/Weblog/assets/js/66.89f67105.js"><link rel="prefetch" href="/Weblog/assets/js/67.4d546178.js"><link rel="prefetch" href="/Weblog/assets/js/68.b3742591.js"><link rel="prefetch" href="/Weblog/assets/js/69.e2c032ec.js"><link rel="prefetch" href="/Weblog/assets/js/7.1f4a6057.js"><link rel="prefetch" href="/Weblog/assets/js/70.f262dfb0.js"><link rel="prefetch" href="/Weblog/assets/js/71.24d5a255.js"><link rel="prefetch" href="/Weblog/assets/js/72.c2fad7bd.js"><link rel="prefetch" href="/Weblog/assets/js/73.e3de86c7.js"><link rel="prefetch" href="/Weblog/assets/js/74.af039d36.js"><link rel="prefetch" href="/Weblog/assets/js/75.b5d26a4d.js"><link rel="prefetch" href="/Weblog/assets/js/76.5253b8d4.js"><link rel="prefetch" href="/Weblog/assets/js/77.13049fae.js"><link rel="prefetch" href="/Weblog/assets/js/78.732e7950.js"><link rel="prefetch" href="/Weblog/assets/js/79.91a95405.js"><link rel="prefetch" href="/Weblog/assets/js/8.5b6e1357.js"><link rel="prefetch" href="/Weblog/assets/js/80.60b08cac.js"><link rel="prefetch" href="/Weblog/assets/js/81.09852d19.js"><link rel="prefetch" href="/Weblog/assets/js/82.49b521d3.js"><link rel="prefetch" href="/Weblog/assets/js/83.681a706a.js"><link rel="prefetch" href="/Weblog/assets/js/84.ca93e702.js"><link rel="prefetch" href="/Weblog/assets/js/85.9813d878.js"><link rel="prefetch" href="/Weblog/assets/js/86.632f014f.js"><link rel="prefetch" href="/Weblog/assets/js/87.7737cd73.js"><link rel="prefetch" href="/Weblog/assets/js/88.1ec9c00d.js"><link rel="prefetch" href="/Weblog/assets/js/89.bbeb975f.js"><link rel="prefetch" href="/Weblog/assets/js/9.c685ce8f.js"><link rel="prefetch" href="/Weblog/assets/js/90.eda536dd.js"><link rel="prefetch" href="/Weblog/assets/js/91.391681fc.js"><link rel="prefetch" href="/Weblog/assets/js/92.dca04870.js"><link rel="prefetch" href="/Weblog/assets/js/93.01d44a2a.js"><link rel="prefetch" href="/Weblog/assets/js/94.f941a99a.js"><link rel="prefetch" href="/Weblog/assets/js/95.232bf755.js"><link rel="prefetch" href="/Weblog/assets/js/96.d381c6e0.js"><link rel="prefetch" href="/Weblog/assets/js/97.2a0ba8ba.js"><link rel="prefetch" href="/Weblog/assets/js/98.001e708c.js"><link rel="prefetch" href="/Weblog/assets/js/99.0ff7167d.js">
    <link rel="stylesheet" href="/Weblog/assets/css/styles.bc17a3fe.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/Weblog/" class="home-link router-link-active"><!----><span class="site-name">
      AlexTao çš„ åšå®¢
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/Weblog/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Classify</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/Weblog/html_css/" class="nav-link">HTML/CSS</a></li><li class="dropdown-item"><!----><a href="/Weblog/javascript/" class="nav-link">Javascript</a></li><li class="dropdown-item"><!----><a href="/Weblog/node/" class="nav-link">Node.js</a></li><li class="dropdown-item"><!----><a href="/Weblog/frames/" class="nav-link">Frames</a></li><li class="dropdown-item"><!----><a href="/Weblog/tool/" class="nav-link">Tool</a></li><li class="dropdown-item"><!----><a href="/Weblog/currency/" class="nav-link router-link-active">Currency</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/AlexTaoClub" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Weblog/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Classify</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/Weblog/html_css/" class="nav-link">HTML/CSS</a></li><li class="dropdown-item"><!----><a href="/Weblog/javascript/" class="nav-link">Javascript</a></li><li class="dropdown-item"><!----><a href="/Weblog/node/" class="nav-link">Node.js</a></li><li class="dropdown-item"><!----><a href="/Weblog/frames/" class="nav-link">Frames</a></li><li class="dropdown-item"><!----><a href="/Weblog/tool/" class="nav-link">Tool</a></li><li class="dropdown-item"><!----><a href="/Weblog/currency/" class="nav-link router-link-active">Currency</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/AlexTaoClub" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><!----></nav><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>currency</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/Weblog/currency/" aria-current="page" class="sidebar-link">è®¡ç®—æœº</a></li><li><a href="/Weblog/currency/å‰ç«¯å¼€å‘è§„èŒƒ.html" class="sidebar-link">ç¼–ç è§„èŒƒ</a></li><li><a href="/Weblog/currency/DevOps.html" aria-current="page" class="active sidebar-link">DevOps</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Weblog/currency/DevOps.html#linuxåŸºç¡€" class="sidebar-link">LinuxåŸºç¡€</a></li><li class="sidebar-sub-header"><a href="/Weblog/currency/DevOps.html#nginxåŸºç¡€" class="sidebar-link">NginxåŸºç¡€</a></li><li class="sidebar-sub-header"><a href="/Weblog/currency/DevOps.html#pm2åŸºç¡€" class="sidebar-link">PM2åŸºç¡€</a></li></ul></li><li><a href="/Weblog/currency/é¡¹ç›®è‡ªåŠ¨åŒ–éƒ¨ç½².html" class="sidebar-link">é¡¹ç›®è‡ªåŠ¨åŒ–éƒ¨ç½²</a></li><li><a href="/Weblog/currency/å‰ç«¯å®‰å…¨.html" class="sidebar-link">å‰ç«¯å®‰å…¨</a></li><li><a href="/Weblog/currency/å‰ç«¯ç®—æ³•.html" class="sidebar-link">å‰ç«¯ç®—æ³•</a></li><li><a href="/Weblog/currency/å‡½æ•°å®ç°.html" class="sidebar-link">å‡½æ•°å®ç°</a></li><li><a href="/Weblog/currency/é€šç”¨å‡½æ•°.html" class="sidebar-link">é€šç”¨å‡½æ•°</a></li><li><a href="/Weblog/currency/ä¾‹é¢˜æ€»ç»“.html" class="sidebar-link">ä¾‹é¢˜åˆ†æ </a></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="devops">DevOps</h1><h2 id="linuxåŸºç¡€">LinuxåŸºç¡€</h2><h3 id="å…¬åŒ™ä¿¡ä»»">å…¬åŒ™ä¿¡ä»»</h3><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># ç”Ÿæˆå…¬é’¥</span>
ssh-keygen -t rsa -P <span class="token string">''</span>

xubin@xubindeMBP:~$ ssh-keygen
Generating public/private rsa key pair.
Enter <span class="token function">file</span> <span class="token keyword">in</span> <span class="token function">which</span> to save the key <span class="token punctuation">(</span>/Users/xubin/.ssh/id_rsa<span class="token punctuation">)</span>:
/Users/xubin/.ssh/id_rsa already exists.
Overwrite <span class="token punctuation">(</span>y/n<span class="token punctuation">)</span>? <span class="token function">yes</span>
Enter passphrase <span class="token punctuation">(</span>empty <span class="token keyword">for</span> no passphrase<span class="token punctuation">)</span>:
Enter same passphrase again:
Your identification has been saved <span class="token keyword">in</span> /Users/xubin/.ssh/id_rsa.
Your public key has been saved <span class="token keyword">in</span> /Users/xubin/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:IeFPfrcQ3hhP64SRTAFzGIHl2ROcopl5HotRi2XNOGk xubin@xubindeMBP
The key's randomart image is:
+---<span class="token punctuation">[</span>RSA <span class="token number">2048</span><span class="token punctuation">]</span>----+
<span class="token operator">|</span>      .o*@<span class="token operator">=</span>o     <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token punctuation">..</span>oEB<span class="token operator">=</span>o     <span class="token operator">|</span>
<span class="token operator">|</span>      o@<span class="token operator">=</span>+O <span class="token builtin class-name">.</span>    <span class="token operator">|</span>
<span class="token operator">|</span>      <span class="token assign-left variable">B</span><span class="token operator">=</span>+o @ <span class="token builtin class-name">.</span>   <span class="token operator">|</span>
<span class="token operator">|</span>       <span class="token operator">=</span>So* *    <span class="token operator">|</span>
<span class="token operator">|</span>      <span class="token builtin class-name">.</span> o. <span class="token operator">=</span> <span class="token builtin class-name">.</span>   <span class="token operator">|</span>
<span class="token operator">|</span>            o    <span class="token operator">|</span>
<span class="token operator">|</span>                 <span class="token operator">|</span>
<span class="token operator">|</span>                 <span class="token operator">|</span>
+----<span class="token punctuation">[</span>SHA256<span class="token punctuation">]</span>-----+

<span class="token comment"># æŸ¥çœ‹å…¬é’¥</span>
<span class="token function">cat</span> .ssh/id_rsa.pub 

<span class="token comment"># å°†å…¬é’¥æ‹·è´åˆ°æœåŠ¡å™¨</span>
<span class="token function">scp</span> ~/.ssh/id_rsa.pub root@47.98.252.XXX:/root

<span class="token comment"># å°†å…¬é’¥åŠ å…¥ä¿¡ä»»åˆ—è¡¨</span>
<span class="token function">cat</span> id_dsa.pub <span class="token operator">&gt;&gt;</span> ~/.ssh/authorized_keys
</code></pre></div><h3 id="sshç™»å½•">SSHç™»å½•</h3><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># root ä¸ºç”¨æˆ·å</span>
<span class="token comment"># ipåœ°å€</span>
<span class="token function">ssh</span> root@47.98.252.XXX
</code></pre></div><h3 id="ç›®å½•æ“ä½œ">ç›®å½•æ“ä½œ</h3><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># æŸ¥çœ‹ç›®å½•</span>
<span class="token builtin class-name">pwd</span>

<span class="token comment"># æ”¹å˜å½“å‰ç›®å½•</span>
<span class="token builtin class-name">cd</span> <span class="token punctuation">[</span>directory_name<span class="token punctuation">]</span>

<span class="token comment"># åˆ—å‡ºå½“å‰ç›®å½•çš„æ–‡ä»¶å’Œå­ç›®å½•</span>
<span class="token function">ls</span>

<span class="token function">ls</span> -a     åˆ—å‡ºæ‰€æœ‰ç›®å½•ã€å­ç›®å½•ã€æ–‡ä»¶å’Œéšè—æ–‡ä»¶

<span class="token function">ls</span> -R     åˆ—å‡ºä»å½“å‰ç›®å½•å¼€å§‹çš„æ‰€æœ‰çš„å­ç›®å½•ã€æ–‡ä»¶å¹¶ä¸”ä¸€å±‚å±‚å¾€ä¸‹æ˜¾ç¤º

<span class="token function">ls</span> -F     åˆ—å‡ºæ–‡ä»¶ã€ç›®å½•åå¹¶æ˜¾ç¤ºå‡ºæ–‡ä»¶ç±»å‹

<span class="token function">ls</span> -t     ä»¥ä¿®æ”¹æ—¶é—´ä¸ºæ—¶é—´å€’åºæ¥åˆ—å‡ºæ–‡ä»¶ã€å­ç›®å½•

<span class="token function">ls</span> -l     ä»¥é•¿åˆ—è¡¨æ ¼å¼æ˜¾ç¤ºæ–‡ä»¶ã€ç›®å½•çš„è¯¦ç»†ä¿¡æ¯
</code></pre></div><h3 id="æ–‡æœ¬æ“ä½œ">æ–‡æœ¬æ“ä½œ</h3><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># æŸ¥çœ‹æ“ä½œ</span>
<span class="token function">cat</span> xxx

<span class="token comment"># åŠ¨æ€æŸ¥çœ‹ä¿¡æ¯</span>
<span class="token function">tail</span> -f xxx.log
</code></pre></div><h3 id="ç³»ç»Ÿä¿¡æ¯æŸ¥çœ‹">ç³»ç»Ÿä¿¡æ¯æŸ¥çœ‹</h3><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># ç£ç›˜å®¹é‡</span>
<span class="token function">df</span> -h

<span class="token comment"># ç³»ç»Ÿé…ç½®</span>
<span class="token function">cat</span> /proc/cpuinfo 

<span class="token comment"># å‘è¡Œç‰ˆæœ¬</span>
lsb_release -a
</code></pre></div><h3 id="ç³»ç»Ÿè¿›ç¨‹">ç³»ç»Ÿè¿›ç¨‹</h3><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># åˆ—å‡ºç³»ç»Ÿä¸­å½“å‰è¿è¡Œçš„é‚£äº›è¿›ç¨‹</span>
<span class="token function">ps</span>
-a æ˜¾ç¤ºåŒä¸€ç»ˆç«¯ä¸‹çš„æ‰€æœ‰ç¨‹åº
-A æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹
c  æ˜¾ç¤ºè¿›ç¨‹çš„çœŸå®åç§°
-N åå‘é€‰æ‹©
-e ç­‰äºâ€œ-Aâ€
e  æ˜¾ç¤ºç¯å¢ƒå˜é‡
f  æ˜¾ç¤ºç¨‹åºé—´çš„å…³ç³»
-H æ˜¾ç¤ºæ ‘çŠ¶ç»“æ„
r  æ˜¾ç¤ºå½“å‰ç»ˆç«¯çš„è¿›ç¨‹
T  æ˜¾ç¤ºå½“å‰ç»ˆç«¯çš„æ‰€æœ‰ç¨‹åº
u  æŒ‡å®šç”¨æˆ·çš„æ‰€æœ‰è¿›ç¨‹
-au æ˜¾ç¤ºè¾ƒè¯¦ç»†çš„èµ„è®¯
-aux æ˜¾ç¤ºæ‰€æœ‰åŒ…å«å…¶ä»–ä½¿ç”¨è€…çš„è¡Œç¨‹ 

<span class="token comment"># åŠ¨æ€æŸ¥çœ‹è¿›ç¨‹å˜åŒ–ï¼Œç›‘æ§linuxçš„ç³»ç»ŸçŠ¶å†µ</span>
<span class="token function">top</span> 
<span class="token comment"># top è¿è¡Œä¸­å¯ä»¥é€šè¿‡ top çš„å†…éƒ¨å‘½ä»¤å¯¹è¿›ç¨‹çš„æ˜¾ç¤ºæ–¹å¼è¿›è¡Œæ§åˆ¶ã€‚å†…éƒ¨å‘½ä»¤å¦‚ä¸‹ï¼š</span>
s â€“ æ”¹å˜ç”»é¢æ›´æ–°é¢‘ç‡
l â€“ å…³é—­æˆ–å¼€å¯ç¬¬ä¸€éƒ¨åˆ†ç¬¬ä¸€è¡Œ <span class="token function">top</span> ä¿¡æ¯çš„è¡¨ç¤º
t â€“ å…³é—­æˆ–å¼€å¯ç¬¬ä¸€éƒ¨åˆ†ç¬¬äºŒè¡Œ Tasks å’Œç¬¬ä¸‰è¡Œ Cpus ä¿¡æ¯çš„è¡¨ç¤º
m â€“ å…³é—­æˆ–å¼€å¯ç¬¬ä¸€éƒ¨åˆ†ç¬¬å››è¡Œ Mem å’Œ ç¬¬äº”è¡Œ Swap ä¿¡æ¯çš„è¡¨ç¤º
N â€“ ä»¥ PID çš„å¤§å°çš„é¡ºåºæ’åˆ—è¡¨ç¤ºè¿›ç¨‹åˆ—è¡¨
P â€“ ä»¥ CPU å ç”¨ç‡å¤§å°çš„é¡ºåºæ’åˆ—è¿›ç¨‹åˆ—è¡¨
M â€“ ä»¥å†…å­˜å ç”¨ç‡å¤§å°çš„é¡ºåºæ’åˆ—è¿›ç¨‹åˆ—è¡¨
h â€“ æ˜¾ç¤ºå¸®åŠ©
n â€“ è®¾ç½®åœ¨è¿›ç¨‹åˆ—è¡¨æ‰€æ˜¾ç¤ºè¿›ç¨‹çš„æ•°é‡
q â€“ é€€å‡º <span class="token function">top</span>
s â€“ æ”¹å˜ç”»é¢æ›´æ–°å‘¨æœŸ

<span class="token comment"># æ€æ­»è¿›ç¨‹</span>
<span class="token function">kill</span>
-l  ä¿¡å·ï¼Œè‹¥æœä¸åŠ ä¿¡å·çš„ç¼–å·å‚æ•°ï¼Œåˆ™ä½¿ç”¨â€œ-lâ€å‚æ•°ä¼šåˆ—å‡ºå…¨éƒ¨çš„ä¿¡å·åç§°
-a  å½“å¤„ç†å½“å‰è¿›ç¨‹æ—¶ï¼Œä¸é™åˆ¶å‘½ä»¤åå’Œè¿›ç¨‹å·çš„å¯¹åº”å…³ç³»
-p  æŒ‡å®škill å‘½ä»¤åªæ‰“å°ç›¸å…³è¿›ç¨‹çš„è¿›ç¨‹å·ï¼Œè€Œä¸å‘é€ä»»ä½•ä¿¡å·
-s  æŒ‡å®šå‘é€ä¿¡å·
-u  æŒ‡å®šç”¨æˆ· 

<span class="token comment"># å…ˆç”¨psæŸ¥æ‰¾è¿›ç¨‹ï¼Œç„¶åç”¨killæ€æ‰</span>
<span class="token function">ps</span> -ef<span class="token operator">|</span><span class="token function">grep</span> <span class="token function">vim</span> 
</code></pre></div><h3 id="ç½‘ç»œçŠ¶å†µ">ç½‘ç»œçŠ¶å†µ</h3><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># ç›‘æ§TCP/IPç½‘ç»œ</span>
<span class="token function">netstat</span>
<span class="token comment"># åˆ—å‡ºæ‰€æœ‰ç«¯å£æƒ…å†µ</span>
<span class="token punctuation">[</span>root@xiesshavip002 ~<span class="token punctuation">]</span><span class="token comment"># netstat -a      # åˆ—å‡ºæ‰€æœ‰ç«¯å£</span>
<span class="token punctuation">[</span>root@xiesshavip002 ~<span class="token punctuation">]</span><span class="token comment"># netstat -at     # åˆ—å‡ºæ‰€æœ‰TCPç«¯å£</span>
<span class="token punctuation">[</span>root@xiesshavip002 ~<span class="token punctuation">]</span><span class="token comment"># netstat -au     # åˆ—å‡ºæ‰€æœ‰UDPç«¯å£</span>

<span class="token comment"># åˆ—å‡ºæ‰€æœ‰å¤„äºç›‘å¬çŠ¶æ€çš„Sockets</span>
<span class="token punctuation">[</span>root@xiesshavip002 ~<span class="token punctuation">]</span><span class="token comment"># netstat -l   # åªæ˜¾ç¤ºç›‘å¬ç«¯å£</span>
<span class="token punctuation">[</span>root@xiesshavip002 ~<span class="token punctuation">]</span><span class="token comment"># netstat -lt  # æ˜¾ç¤ºç›‘å¬TCPç«¯å£</span>
<span class="token punctuation">[</span>root@xiesshavip002 ~<span class="token punctuation">]</span><span class="token comment"># netstat -lu  # æ˜¾ç¤ºç›‘å¬UDPç«¯å£</span>
<span class="token punctuation">[</span>root@xiesshavip002 ~<span class="token punctuation">]</span><span class="token comment"># netstat -lx  # æ˜¾ç¤ºç›‘å¬UNIXç«¯å£</span>

<span class="token comment"># æ˜¾ç¤º PID å’Œè¿›ç¨‹åç§°</span>
<span class="token punctuation">[</span>root@xiesshavip002 ~<span class="token punctuation">]</span><span class="token comment"># netstat -p</span>

<span class="token comment"># æ˜¾ç¤ºæ ¸å¿ƒè·¯ç”±ä¿¡æ¯</span>
<span class="token punctuation">[</span>root@xiesshavip002 ~<span class="token punctuation">]</span><span class="token comment"># netstat -r</span>
Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
default         gateway         <span class="token number">0.0</span>.0.0         UG        <span class="token number">0</span> <span class="token number">0</span>          <span class="token number">0</span> eth0
<span class="token number">192.168</span>.130.0   <span class="token number">0.0</span>.0.0         <span class="token number">255.255</span>.255.0   U         <span class="token number">0</span> <span class="token number">0</span>          <span class="token number">0</span> eth0
<span class="token punctuation">[</span>root@xiesshavip002 ~<span class="token punctuation">]</span><span class="token comment"># netstat -rn   # æ˜¾ç¤ºæ•°å­—æ ¼å¼ï¼Œä¸æŸ¥è¯¢ä¸»æœºåç§°</span>
Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
<span class="token number">0.0</span>.0.0         <span class="token number">192.168</span>.130.1   <span class="token number">0.0</span>.0.0         UG        <span class="token number">0</span> <span class="token number">0</span>          <span class="token number">0</span> eth0
<span class="token number">192.168</span>.130.0   <span class="token number">0.0</span>.0.0         <span class="token number">255.255</span>.255.0   U         <span class="token number">0</span> <span class="token number">0</span>          <span class="token number">0</span> eth0

<span class="token comment"># æŸ¥çœ‹ç«¯å£å’ŒæœåŠ¡</span>
<span class="token punctuation">[</span>root@xiesshavip002 ~<span class="token punctuation">]</span><span class="token comment"># netstat -antp | grep ssh</span>
tcp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">0.0</span>.0.0:22              <span class="token number">0.0</span>.0.0:*               LISTEN      <span class="token number">734</span>/sshd            
tcp        <span class="token number">0</span>     <span class="token number">52</span> <span class="token number">192.168</span>.130.20:22       <span class="token number">119.129</span>.118.189:58737   ESTABLISHED <span class="token number">1846</span>/sshd: root@pts 
tcp6       <span class="token number">0</span>      <span class="token number">0</span> :::22                   :::*                    LISTEN      <span class="token number">734</span>/sshd            
<span class="token punctuation">[</span>root@xiesshavip002 ~<span class="token punctuation">]</span><span class="token comment"># netstat -antp | grep 22</span>
tcp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">0.0</span>.0.0:22              <span class="token number">0.0</span>.0.0:*               LISTEN      <span class="token number">734</span>/sshd            
tcp        <span class="token number">0</span>     <span class="token number">52</span> <span class="token number">192.168</span>.130.20:22       <span class="token number">119.129</span>.118.189:58737   ESTABLISHED <span class="token number">1846</span>/sshd: root@pts 
tcp6       <span class="token number">0</span>      <span class="token number">0</span> :::22                   :::*                    LISTEN      <span class="token number">734</span>/sshd            
<span class="token punctuation">[</span>root@xiesshavip002 ~<span class="token punctuation">]</span><span class="token comment">#</span>

<span class="token comment"># ç½‘ç»œæŠ“åŒ…å·¥å…·</span>
tcpdump -nn -i eth0 icmp
</code></pre></div><h3 id="ç³»ç»ŸæœåŠ¡ç®¡ç†å™¨">ç³»ç»ŸæœåŠ¡ç®¡ç†å™¨</h3><div class="language-bash extra-class"><pre class="language-bash"><code>systemctl

<span class="token comment"># æ˜¾ç¤º ç³»ç»ŸçŠ¶æ€:</span>
systemctl status
</code></pre></div><h2 id="nginxåŸºç¡€">NginxåŸºç¡€</h2><p><a href="https://mp.weixin.qq.com/s/wecUdGnuHdZOs3t7zc16jw" target="_blank" rel="noopener noreferrer">nginxæŠ€æœ¯åˆ†æ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h3 id="å®‰è£…">å®‰è£…</h3><ul><li><p>window nginx.exe</p></li><li><p>é€šè¿‡åŒ…ç®¡ç†å®‰è£…
<code>shell</code></p><p><code>sudo apt-get install nginx #ubuntu</code></p><p><code>sudo yum install nginx #centos</code></p><p><code>sudo brew install nginx #mac</code></p></li><li><p>å®˜ç½‘ä¸‹è½½æºç ï¼Œå®‰è£…ä¾èµ–ï¼Œç¼–è¯‘åå®‰è£…</p></li><li><p>dockerå®‰è£… dockerhub</p></li></ul><h3 id="å¸¸ç”¨å‘½ä»¤">å¸¸ç”¨å‘½ä»¤</h3><div class="language- extra-class"><pre class="language-text"><code>nginx -v / -V æŸ¥çœ‹ç‰ˆæœ¬ / æŸ¥çœ‹ç‰ˆæœ¬å’Œé…ç½®ä¿¡æ¯ï¼ˆä¾èµ–åº“çš„æœ¬ä¿¡æ¯ï¼‰
nginx -t æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•çŠ¶æ€,é…ç½®æ–‡ä»¶ä½ç½®
		# nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
		# nginx: configuration file /etc/nginx/nginx.conf test is successful
nginx -s quite å…³é—­æœåŠ¡ï¼ˆä¼˜é›…å…³é—­ï¼Œç­‰å¾…å½“å‰å·²å»ºç«‹çš„è¿æ¥å®Œæˆåå…³é—­æœåŠ¡ï¼‰
nginx -s stop ç›´æ¥åœæ­¢æœåŠ¡
nginx -s reload çƒ­é‡è½½ï¼Œä¸åœæ­¢æœåŠ¡çš„æƒ…å†µä¸‹é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼Œå®ŒæˆæœåŠ¡é‡å¯
nginx -s reopen é‡æ–°å¼€å§‹æ—¥å¿—æ–‡ä»¶
service nginx restart é‡å¯
</code></pre></div><h3 id="é™æ€èµ„æº">é™æ€èµ„æº</h3><div class="language- extra-class"><pre class="language-text"><code>http {
    gzip  on;
    gzip_vary on;
    gzip_proxied any;
    gzip_min_length  5k;
    gzip_buffers  4 16k;
    gzip_http_version 1.1;
    gzip_comp_level 4;
    gzip_types  application/javascript text/plain application/x-javascript text/css application/xml application/json text/javascript;
    gzip_disable &quot;MSIE [1-6]\.(?!.*SV1)&quot;;

    server {
        server_name Alex.com www.Alex.com;
        listen 80;
        root /home/baixx2/project;
        location / {
            index index.htm index.html;
        }
        # vue-router historyæ¨¡å¼
        location / {
            try_files $uri $uri/ /index.html;
        }
        # èµ„æºè®¾ç½®ç¼“å­˜
        location ~ \.(css|js|woff2|png) {
           #expires 10d;
           add_header Cache-Control max-age=4800;
        }
    }
} 
</code></pre></div><h3 id="åå‘ä»£ç†">åå‘ä»£ç†</h3><div class="language-bash extra-class"><pre class="language-bash"><code>http <span class="token punctuation">{</span>
    <span class="token comment">#  /node_proxy</span>
    upstream node_proxy<span class="token punctuation">{</span>   <span class="token comment">#è¿™é‡Œubuntuå¯ä»¥ä¸ºå…¶ä»–è‡ªå®šä¹‰å­—ç¬¦ä¸²ï¼Œä¸‹æ–¹éœ€è¦å¡«å†™å¯¹åº”å­—ç¬¦ä¸²</span>
        server <span class="token number">127.0</span>.0.1:3000<span class="token punctuation">;</span>  <span class="token comment">#3000ä¸ºéœ€è¦è½¬å‘çš„ç«¯å£å·</span>
    <span class="token punctuation">}</span>
    server<span class="token punctuation">{</span>
        listen <span class="token number">80</span><span class="token punctuation">;</span>  <span class="token comment">#90ä¸ºè½¬å‘åˆ°çš„ç«¯å£å·</span>
        location / <span class="token punctuation">{</span>
            proxy_set_header X-Real-IP <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>
            proxy_set_header X-Forward-For <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>
            proxy_set_header Host <span class="token variable">$http_host</span><span class="token punctuation">;</span>
            proxy_set_header X-Nginx-Proxy <span class="token boolean">true</span><span class="token punctuation">;</span>
            proxy_pass http://node_proxy<span class="token punctuation">;</span>  <span class="token comment">#ä¸ä¸Šæ–¹å¯¹åº”</span>
            proxy_redirect off<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="websocket-ioæ”¯æŒ">Websocket.ioæ”¯æŒ</h3><div class="language-bash extra-class"><pre class="language-bash"><code>location ~* <span class="token punctuation">\</span>.io <span class="token punctuation">{</span>
	proxy_set_header X-Real-IP <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>
	proxy_set_header X-Forwarded-For <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>
	proxy_set_header Host <span class="token variable">$http_host</span><span class="token punctuation">;</span>
	proxy_set_header X-NginX-Proxy <span class="token boolean">true</span><span class="token punctuation">;</span>
 
	proxy_pass http://localhost:3000<span class="token punctuation">;</span>
	proxy_redirect off<span class="token punctuation">;</span>
 
	proxy_http_version <span class="token number">1.1</span><span class="token punctuation">;</span>
	proxy_set_header Upgrade <span class="token variable">$http_upgrade</span><span class="token punctuation">;</span>
	proxy_set_header Connection <span class="token string">&quot;upgrade&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="httpsæ”¯æŒ">HTTPSæ”¯æŒ</h3><blockquote><p>å®‰å…¨é€šè®¯çš„ä¼ è¾“åè®®</p><ul><li>ç½‘ç«™æœåŠ¡å™¨çš„èº«ä»½è®¤è¯</li><li>ä¿æŠ¤äº¤æ¢æ•°æ®çš„çš„éšç§å’Œå®Œæ•´æ€§</li><li>é˜²æ­¢äººä¸ºæ”»å‡»</li><li>è¿è¥å•†åŠ«æŒ</li><li>æ–°ç‰¹æ€§ WebRTC ã€Service Workerçš„å‰å°è¦ç´ </li></ul></blockquote><h3 id="nginx-conf-è¯¦è§£">nginx.conf è¯¦è§£</h3><p><strong>å®šä¹‰Nginxè¿è¡Œçš„ç”¨æˆ·å’Œç”¨æˆ·ç»„</strong></p><p><code>user www www</code></p><p><strong>nginxè¿›ç¨‹æ•°ï¼Œå»ºè®®è®¾ç½®ä¸ºç­‰äºCPUæ€»æ ¸å¿ƒæ•°</strong></p><p><code>worker_processes 8</code></p><p><strong>å…¨å±€é”™è¯¯æ—¥å¿—å®šä¹‰ç±»å‹ï¼Œ[ debug | info | notice | warn | error | crit ]</strong></p><p><code>error_log /**var**/log/nginx/error.log info</code></p><p><strong>è¿›ç¨‹æ–‡ä»¶</strong></p><p><code>pid /**var**/run/nginx.pid;</code></p><p><strong>ä¸€ä¸ªnginxè¿›ç¨‹æ‰“å¼€çš„æœ€å¤šæ–‡ä»¶æè¿°ç¬¦æ•°ç›®ï¼Œç†è®ºå€¼åº”è¯¥æ˜¯æœ€å¤šæ‰“å¼€æ–‡ä»¶æ•°ï¼ˆç³»ç»Ÿçš„å€¼ulimit -nï¼‰ä¸nginxè¿›ç¨‹æ•°ç›¸é™¤ï¼Œä½†æ˜¯nginxåˆ†é…è¯·æ±‚å¹¶ä¸å‡åŒ€ï¼Œæ‰€ä»¥å»ºè®®ä¸ulimit -nçš„å€¼ä¿æŒä¸€è‡´ã€‚</strong></p><p><code>worker_rlimit_nofile 65535;</code></p><p><strong>å·¥ä½œæ¨¡å¼ä¸è¿æ¥æ•°ä¸Šé™</strong></p><div class="language- extra-class"><pre class="language-text"><code>events{
    #å‚è€ƒäº‹ä»¶æ¨¡å‹ï¼Œ
    use [ kqueue | rtsig | epoll | /dev/poll | select | poll ]; 
    #epollæ¨¡å‹æ˜¯Linux 2.6ä»¥ä¸Šç‰ˆæœ¬å†…æ ¸ä¸­çš„é«˜æ€§èƒ½ç½‘ç»œI/Oæ¨¡å‹ï¼Œå¦‚æœè·‘åœ¨FreeBSDä¸Šé¢ï¼Œå°±ç”¨kqueueæ¨¡å‹ã€‚
    use epoll;
    #å•ä¸ªè¿›ç¨‹æœ€å¤§è¿æ¥æ•°ï¼ˆæœ€å¤§è¿æ¥æ•°=è¿æ¥æ•°*è¿›ç¨‹æ•°ï¼‰
    worker_connections 65535;
}
</code></pre></div><p><strong>è®¾å®šhttpæœåŠ¡å™¨</strong></p><div class="language- extra-class"><pre class="language-text"><code>http{
    include mime.types; #æ–‡ä»¶æ‰©å±•åä¸æ–‡ä»¶ç±»å‹æ˜ å°„è¡¨
    default_type application/octet-stream; #é»˜è®¤æ–‡ä»¶ç±»å‹
    #charset utf-8; #é»˜è®¤ç¼–ç 
    server_names_hash_bucket_size 128; #æœåŠ¡å™¨åå­—çš„hashè¡¨å¤§å°
    client_header_buffer_size 32k; #ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶
    large_client_header_buffers 4 64k; #è®¾å®šè¯·æ±‚ç¼“
    client_max_body_size 8m; #è®¾å®šè¯·æ±‚ç¼“
    sendfile on; #å¼€å¯é«˜æ•ˆæ–‡ä»¶ä¼ è¾“æ¨¡å¼ï¼ŒsendfileæŒ‡ä»¤æŒ‡å®šnginxæ˜¯å¦è°ƒç”¨sendfileå‡½æ•°æ¥è¾“å‡ºæ–‡ä»¶ï¼Œå¯¹äºæ™®é€šåº”ç”¨è®¾ä¸º onï¼Œå¦‚æœç”¨æ¥è¿›è¡Œä¸‹è½½ç­‰åº”ç”¨ç£ç›˜IOé‡è´Ÿè½½åº”ç”¨ï¼Œå¯è®¾ç½®ä¸ºoffï¼Œä»¥å¹³è¡¡ç£ç›˜ä¸ç½‘ç»œI/Oå¤„ç†é€Ÿåº¦ï¼Œé™ä½ç³»ç»Ÿçš„è´Ÿè½½ã€‚æ³¨æ„ï¼šå¦‚æœå›¾ç‰‡æ˜¾ç¤ºä¸æ­£å¸¸æŠŠè¿™ä¸ªæ”¹æˆoffã€‚
    autoindex on; #å¼€å¯ç›®å½•åˆ—è¡¨è®¿é—®ï¼Œåˆé€‚ä¸‹è½½æœåŠ¡å™¨ï¼Œé»˜è®¤å…³é—­ã€‚
    tcp_nopush on; #é˜²æ­¢ç½‘ç»œé˜»å¡
    tcp_nodelay on; #é˜²æ­¢ç½‘ç»œé˜»å¡
    keepalive_timeout 120; #é•¿è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ˜¯ç§’

    #FastCGIç›¸å…³å‚æ•°æ˜¯ä¸ºäº†æ”¹å–„ç½‘ç«™çš„æ€§èƒ½ï¼šå‡å°‘èµ„æºå ç”¨ï¼Œæé«˜è®¿é—®é€Ÿåº¦ã€‚ä¸‹é¢å‚æ•°çœ‹å­—é¢æ„æ€éƒ½èƒ½ç†è§£ã€‚
    fastcgi_connect_timeout 300;
    fastcgi_send_timeout 300;
    fastcgi_read_timeout 300;
    fastcgi_buffer_size 64k;
    fastcgi_buffers 4 64k;
    fastcgi_busy_buffers_size 128k;
    fastcgi_temp_file_write_size 128k;

    #gzipæ¨¡å—è®¾ç½®
    gzip on; #å¼€å¯gzipå‹ç¼©è¾“å‡º
    gzip_min_length 1k; #æœ€å°å‹ç¼©æ–‡ä»¶å¤§å°
    gzip_buffers 4 16k; #å‹ç¼©ç¼“å†²åŒº
    gzip_http_version 1.0; #å‹ç¼©ç‰ˆæœ¬ï¼ˆé»˜è®¤1.1ï¼Œå‰ç«¯å¦‚æœæ˜¯squid2.5è¯·ä½¿ç”¨1.0ï¼‰
    gzip_comp_level 2; #å‹ç¼©ç­‰çº§
    gzip_types text/plain application/x-javascript text/css application/xml;
    #å‹ç¼©ç±»å‹ï¼Œé»˜è®¤å°±å·²ç»åŒ…å«text/htmlï¼Œæ‰€ä»¥ä¸‹é¢å°±ä¸ç”¨å†å†™äº†ï¼Œå†™ä¸Šå»ä¹Ÿä¸ä¼šæœ‰é—®é¢˜ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€ä¸ªwarnã€‚
    gzip_vary on;
    #limit_zone crawler $binary_remote_addr 10m; #å¼€å¯é™åˆ¶IPè¿æ¥æ•°çš„æ—¶å€™éœ€è¦ä½¿ç”¨

    upstream blog.ha97.com {
        #upstreamçš„è´Ÿè½½å‡è¡¡ï¼Œweightæ˜¯æƒé‡ï¼Œå¯ä»¥æ ¹æ®æœºå™¨é…ç½®å®šä¹‰æƒé‡ã€‚weigthå‚æ•°è¡¨ç¤ºæƒå€¼ï¼Œæƒå€¼è¶Šé«˜è¢«åˆ†é…åˆ°çš„å‡ ç‡è¶Šå¤§ã€‚
        server 192.168.80.121:80 weight=3;
        server 192.168.80.122:80 weight=2;
        server 192.168.80.123:80 weight=3;
    }
 
    #è™šæ‹Ÿä¸»æœºçš„é…ç½®
    server{
        #ç›‘å¬ç«¯å£
        listen 80;

        #åŸŸåå¯ä»¥æœ‰å¤šä¸ªï¼Œç”¨ç©ºæ ¼éš”å¼€
        server_name www.ha97.com ha97.com;
        index index.html index.htm index.php;
        root /data/www/ha97;
        location ~ .*\.(php|php5)?${
            fastcgi_pass 127.0.0.1:9000;
            fastcgi_index index.php;
            include fastcgi.conf;
        }

        #å›¾ç‰‡ç¼“å­˜æ—¶é—´è®¾ç½®
        location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)${
            expires 10d;
        }

        #JSå’ŒCSSç¼“å­˜æ—¶é—´è®¾ç½®
        location ~ .*\.(js|css)?${
            expires 1h;
        }

        #æ—¥å¿—æ ¼å¼è®¾å®š
        log_format access '$remote_addr - $remote_user [$time_local] &quot;$request&quot; '
        '$status $body_bytes_sent &quot;$http_referer&quot; '
        '&quot;$http_user_agent&quot; $http_x_forwarded_for';

        #å®šä¹‰æœ¬è™šæ‹Ÿä¸»æœºçš„è®¿é—®æ—¥å¿—
        access_log /var/log/nginx/ha97access.log access;

        #å¯¹ &quot;/&quot; å¯ç”¨åå‘ä»£ç†
        location / {
            proxy_pass http://127.0.0.1:88;
            proxy_redirect off;
            proxy_set_header X-Real-IP $remote_addr;

            #åç«¯çš„WebæœåŠ¡å™¨å¯ä»¥é€šè¿‡X-Forwarded-Forè·å–ç”¨æˆ·çœŸå®IP
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

            #ä»¥ä¸‹æ˜¯ä¸€äº›åå‘ä»£ç†çš„é…ç½®ï¼Œå¯é€‰ã€‚
            proxy_set_header Host $host;
            client_max_body_size 10m; #å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å•æ–‡ä»¶å­—èŠ‚æ•°
            client_body_buffer_size 128k; #ç¼“å†²åŒºä»£ç†ç¼“å†²ç”¨æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œ
            proxy_connect_timeout 90; #nginxè·Ÿåç«¯æœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´(ä»£ç†è¿æ¥è¶…æ—¶)
            proxy_send_timeout 90; #åç«¯æœåŠ¡å™¨æ•°æ®å›ä¼ æ—¶é—´(ä»£ç†å‘é€è¶…æ—¶)
            proxy_read_timeout 90; #è¿æ¥æˆåŠŸåï¼Œåç«¯æœåŠ¡å™¨å“åº”æ—¶é—´(ä»£ç†æ¥æ”¶è¶…æ—¶)
            proxy_buffer_size 4k; #è®¾ç½®ä»£ç†æœåŠ¡å™¨ï¼ˆnginxï¼‰ä¿å­˜ç”¨æˆ·å¤´ä¿¡æ¯çš„ç¼“å†²åŒºå¤§å°
            proxy_buffers 4 32k; #proxy_buffersç¼“å†²åŒºï¼Œç½‘é¡µå¹³å‡åœ¨32kä»¥ä¸‹çš„è®¾ç½®
            proxy_busy_buffers_size 64k; #é«˜è´Ÿè·ä¸‹ç¼“å†²å¤§å°ï¼ˆproxy_buffers*2ï¼‰
            proxy_temp_file_write_size 64k;
            #è®¾å®šç¼“å­˜æ–‡ä»¶å¤¹å¤§å°ï¼Œå¤§äºè¿™ä¸ªå€¼ï¼Œå°†ä»upstreamæœåŠ¡å™¨ä¼ 
        }

        #è®¾å®šæŸ¥çœ‹NginxçŠ¶æ€çš„åœ°å€
        location /NginxStatus {
            stub_status on;
            access_log on;
            auth_basic &quot;NginxStatus&quot;;
            auth_basic_user_file conf/htpasswd;
            #htpasswdæ–‡ä»¶çš„å†…å®¹å¯ä»¥ç”¨apacheæä¾›çš„htpasswdå·¥å…·æ¥äº§ç”Ÿã€‚
        }

        #æœ¬åœ°åŠ¨é™åˆ†ç¦»åå‘ä»£ç†é…ç½®
        #æ‰€æœ‰jspçš„é¡µé¢å‡äº¤ç”±tomcatæˆ–resinå¤„ç†
        location ~ .(jsp|jspx|do)?$ {
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_pass http://127.0.0.1:8080;
        }
        #æ‰€æœ‰é™æ€æ–‡ä»¶ç”±nginxç›´æ¥è¯»å–ä¸ç»è¿‡tomcatæˆ–resin
        location ~ .*.(htm|html|gif|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma)${
            expires 15d; 
        }
        location ~ .*.(js|css)?${ 
            expires 1h; 
        }
    }
}
</code></pre></div><h2 id="pm2åŸºç¡€">PM2åŸºç¡€</h2><h3 id="å®‰è£…ä½¿ç”¨">å®‰è£…ä½¿ç”¨</h3><div class="language- extra-class"><pre class="language-text"><code>npm install -g pm2

pm2 start app.js æˆ–è€… pm2 start bin/www  å¯åŠ¨nodeé¡¹ç›®

pm2 stop bin/www  åœæ­¢pm2æœåŠ¡
pm2 stop all åœæ­¢æ‰€æœ‰è¿›ç¨‹
pm2 stop 0 åœæ­¢æŒ‡å®šçš„è¿›ç¨‹

pm2 restart 0 é‡å¯æŒ‡å®šçš„è¿›ç¨‹
pm2 restart all é‡å¯æ‰€æœ‰è¿›ç¨‹
pm2 reload all 0ç§’åœæœºé‡è½½è¿›ç¨‹ (ç”¨äº NETWORKED è¿›ç¨‹)

pm2 delete 0 æ€æ­»æŒ‡å®šçš„è¿›ç¨‹
pm2 delete all æ€æ­»å…¨éƒ¨è¿›ç¨‹

pm2 list åˆ—å‡ºç”±pm2ç®¡ç†çš„æ‰€æœ‰è¿›ç¨‹ä¿¡æ¯ï¼Œè¿˜ä¼šæ˜¾ç¤ºä¸€ä¸ªè¿›ç¨‹ä¼šè¢«å¯åŠ¨å¤šå°‘æ¬¡ï¼Œå› ä¸ºæ²¡å¤„ç†çš„å¼‚å¸¸ã€‚
pm2 monit ç›‘è§†æ¯ä¸ªnodeè¿›ç¨‹çš„CPUå’Œå†…å­˜çš„ä½¿ç”¨æƒ…å†µ
pm2 logs æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹æ—¥å¿—
pm2 startup äº§ç”Ÿ init è„šæœ¬ ä¿æŒè¿›ç¨‹æ´»ç€
pm2 web è¿è¡Œå¥å£®çš„ computer API endpoint (http://localhost:9615)
</code></pre></div><h3 id="è¿è¡Œè¿›ç¨‹çš„ä¸åŒæ–¹å¼ï¼š">è¿è¡Œè¿›ç¨‹çš„ä¸åŒæ–¹å¼ï¼š</h3><div class="language- extra-class"><pre class="language-text"><code>pm2 start app.js -i max æ ¹æ®æœ‰æ•ˆCPUæ•°ç›®å¯åŠ¨æœ€å¤§è¿›ç¨‹æ•°ç›®
pm2 start app.js -i 3 å¯åŠ¨3ä¸ªè¿›ç¨‹
pm2 start app.js -x ç”¨forkæ¨¡å¼å¯åŠ¨ app.js è€Œä¸æ˜¯ä½¿ç”¨ cluster
pm2 start app.js -x -- -a 23 ç”¨forkæ¨¡å¼å¯åŠ¨ app.js å¹¶ä¸”ä¼ é€’å‚æ•° (-a 23)
pm2 start app.js --name serverone å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹å¹¶æŠŠå®ƒå‘½åä¸º serverone
pm2 stop serverone åœæ­¢ serverone è¿›ç¨‹
pm2 start app.json å¯åŠ¨è¿›ç¨‹, åœ¨ app.jsoné‡Œè®¾ç½®é€‰é¡¹
pm2 start app.js -i max -- -a 23 åœ¨--ä¹‹åç»™ app.js ä¼ é€’å‚æ•°
pm2 start app.js -i max -e err.log -o out.log å¯åŠ¨ å¹¶ ç”Ÿæˆä¸€ä¸ªé…ç½®æ–‡ä»¶
</code></pre></div><h3 id="å¯åŠ¨æ–‡ä»¶">å¯åŠ¨æ–‡ä»¶</h3><div class="language- extra-class"><pre class="language-text"><code>{
    &quot;apps&quot;: {                            //appså¯ä»¥æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸€ä¸ªæ•°ç»„æˆå‘˜å°±æ˜¯å¯¹åº”ä¸€ä¸ªpm2ä¸­è¿è¡Œçš„åº”ç”¨
        &quot;name&quot;: &quot;express_project&quot;,       // é¡¹ç›®å          
        &quot;script&quot;: &quot;app.js&quot;,              // æ‰§è¡Œæ–‡ä»¶
        &quot;cwd&quot;: &quot;./&quot;,                     // æ ¹ç›®å½•
        &quot;args&quot;: &quot;&quot;,                      // ä¼ é€’ç»™è„šæœ¬çš„å‚æ•°
        &quot;interpreter&quot;: &quot;&quot;,               // æŒ‡å®šçš„è„šæœ¬è§£é‡Šå™¨
        &quot;interpreter_args&quot;: &quot;&quot;,          // ä¼ é€’ç»™è§£é‡Šå™¨çš„å‚æ•°
        &quot;watch&quot;: true,                   // æ˜¯å¦ç›‘å¬æ–‡ä»¶å˜åŠ¨ç„¶åé‡å¯
        &quot;ignore_watch&quot;: [                // ä¸ç”¨ç›‘å¬çš„æ–‡ä»¶
            &quot;node_modules&quot;,
            &quot;public&quot;
        ],
        &quot;max_memory_restart&quot;: &quot;300M&quot;,    // æœåŠ¡å ç”¨çš„å†…å­˜è¶…è¿‡300Mï¼Œä¼šè‡ªåŠ¨è¿›è¡Œé‡å¯
        &quot;exec_mode&quot;: &quot;cluster_mode&quot;,     // åº”ç”¨å¯åŠ¨æ¨¡å¼ï¼Œæ”¯æŒ fork å’Œ cluster æ¨¡å¼
        &quot;instances&quot;: &quot;max&quot;,              // åº”ç”¨å¯åŠ¨å®ä¾‹ä¸ªæ•°ï¼Œä»…åœ¨ cluster æ¨¡å¼æœ‰æ•ˆ é»˜è®¤ä¸º fork
        &quot;error_file&quot;: &quot;./logs/app-err.log&quot;,         // é”™è¯¯æ—¥å¿—æ–‡ä»¶
        &quot;out_file&quot;: &quot;./logs/app-out.log&quot;,           // æ­£å¸¸æ—¥å¿—æ–‡ä»¶
        &quot;merge_logs&quot;: true,                         // è®¾ç½®è¿½åŠ æ—¥å¿—è€Œä¸æ˜¯æ–°å»ºæ—¥å¿—
        &quot;log_date_format&quot;: &quot;YYYY-MM-DD HH:mm:ss&quot;,   // æŒ‡å®šæ—¥å¿—æ–‡ä»¶çš„æ—¶é—´æ ¼å¼
        &quot;min_uptime&quot;: &quot;60s&quot;,                        // åº”ç”¨è¿è¡Œå°‘äºæ—¶é—´è¢«è®¤ä¸ºæ˜¯å¼‚å¸¸å¯åŠ¨
        &quot;max_restarts&quot;: 30,                         // æœ€å¤§å¼‚å¸¸é‡å¯æ¬¡æ•°
        &quot;autorestart&quot;: true,                        // é»˜è®¤ä¸º true, å‘ç”Ÿå¼‚å¸¸çš„æƒ…å†µä¸‹è‡ªåŠ¨é‡å¯
        &quot;restart_delay&quot;: &quot;60&quot;                       // å¼‚å¸¸é‡å¯æƒ…å†µä¸‹ï¼Œå»¶æ—¶é‡å¯æ—¶é—´
        &quot;env&quot;: {
           &quot;NODE_ENV&quot;: &quot;production&quot;,                // ç¯å¢ƒå‚æ•°ï¼Œå½“å‰æŒ‡å®šä¸ºç”Ÿäº§ç¯å¢ƒ
           &quot;REMOTE_ADDR&quot;: &quot;&quot;               
        },
        &quot;env_dev&quot;: {
            &quot;NODE_ENV&quot;: &quot;development&quot;,              // ç¯å¢ƒå‚æ•°ï¼Œå½“å‰æŒ‡å®šä¸ºå¼€å‘ç¯å¢ƒ
            &quot;REMOTE_ADDR&quot;: &quot;&quot;
        },
        &quot;env_test&quot;: {                               // ç¯å¢ƒå‚æ•°ï¼Œå½“å‰æŒ‡å®šä¸ºæµ‹è¯•ç¯å¢ƒ
            &quot;NODE_ENV&quot;: &quot;test&quot;,
            &quot;REMOTE_ADDR&quot;: &quot;&quot;
        }
    }
}
</code></pre></div><p>Now, let's try it ğŸ‘‰</p></div><div class="page-edit"><!----><!----></div><div class="page-nav"><p class="inner"><span class="prev">
        â† <a href="/Weblog/currency/å‰ç«¯å¼€å‘è§„èŒƒ.html" class="prev">
          ç¼–ç è§„èŒƒ
        </a></span><span class="next"><a href="/Weblog/currency/é¡¹ç›®è‡ªåŠ¨åŒ–éƒ¨ç½².html">
          é¡¹ç›®è‡ªåŠ¨åŒ–éƒ¨ç½²
        </a> â†’
      </span></p></div></div></div></div>
    <script src="/Weblog/assets/js/app.bc17a3fe.js" defer></script><script src="/Weblog/assets/js/20.5b430c8f.js" defer></script>
  </body>
</html>
